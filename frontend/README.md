# Frontend - OpenNext + tRPC + Hono + Cloudflare

A modern Next.js application deployed on Cloudflare Workers using OpenNext, featuring a type-safe UI for managing posts with real-time updates.

## 🚀 Features

- **Edge Computing**: Deployed globally on Cloudflare Workers for minimal latency
- **Type Safety**: End-to-end type safety with tRPC client integration
- **Modern UI**: Beautiful, accessible interface built with shadcn/ui and Tailwind CSS 4
- **Real-time Updates**: Server state management with TanStack Query
- **Responsive Design**: Mobile-first design with Geist fonts
- **Fast Development**: Turbopack for lightning-fast development builds

## 🛠️ Tech Stack

- **Framework**: Next.js 15.4.6 with App Router
- **Runtime**: Bun with Turbopack
- **Deployment**: OpenNext adapter for Cloudflare Workers
- **Styling**: Tailwind CSS 4 with custom theme
- **UI Components**: shadcn/ui (New York style)
- **Fonts**: Geist Sans and Geist Mono
- **Type Safety**: tRPC client with React Query integration
- **Icons**: Lucide React

## 📋 Prerequisites

- **Runtime**: Bun (recommended) or Node.js 18+
- **Cloudflare Account**: With Workers enabled for deployment
- **Backend Service**: Running backend API (Hono + tRPC server)

## 🚀 Quick Start

### Local Development

1. **Install dependencies**
   ```bash
   bun install
   ```

2. **Configure environment variables**
   ```bash
   # Copy the example file
   cp .dev.vars.example .dev.vars

   # Edit .dev.vars with your backend URL
   BACKEND_URL=http://localhost:3001
   ```

3. **Start development server**
   ```bash
   bun run dev
   ```

4. **Open your browser**
   - Navigate to `http://localhost:3000`
   - The app will automatically connect to the backend API

### Alternative: Run with Backend

```bash
# From the root directory (recommended)
bun run dev

# This starts both frontend and backend concurrently
```

## 📁 Project Structure

```
frontend/
├── src/
│   ├── app/                     # Next.js App Router
│   │   ├── api/                 # API routes
│   │   │   └── trpc-proxy/      # tRPC proxy to backend
│   │   │       └── [...trpc]/
│   │   │           └── route.ts  # Proxy route handler
│   │   ├── layout.tsx           # Root layout with providers
│   │   ├── page.tsx             # Home page with post management
│   │   ├── globals.css          # Tailwind CSS with custom theme
│   │   └── favicon.ico
│   ├── lib/
│   │   ├── utils.ts             # Utility functions (cn for class merging)
│   │   └── trpc/
│   │       ├── client.ts        # tRPC client configuration
│   │       ├── provider.tsx     # tRPC provider with React Query
│   │       └── hooks.ts         # Custom tRPC hooks for posts
│   ├── types/
│   │   └── index.ts             # Frontend-specific types
│   └── components/              # (Auto-generated by shadcn/ui)
├── public/                      # Static assets (SVG icons)
├── package.json                 # Frontend dependencies and scripts
├── next.config.ts               # Next.js configuration
├── open-next.config.ts          # OpenNext Cloudflare configuration
├── wrangler.jsonc               # Cloudflare Workers configuration
├── components.json              # shadcn/ui configuration
├── cloudflare-env.d.ts          # Cloudflare environment types
├── eslint.config.mjs            # ESLint configuration
├── postcss.config.mjs           # PostCSS configuration
└── tsconfig.json                # TypeScript configuration
```

## 🏃‍♂️ Development Scripts

```bash
bun run dev          # Start development server with Turbopack
bun run build        # Build for production
bun run start        # Start production server
bun run lint         # Run ESLint
bun run deploy       # Deploy to Cloudflare Workers
bun run preview      # Preview Cloudflare deployment
bun run cf-typegen   # Generate Cloudflare types
```

## 🚢 Deployment

### Cloudflare Workers Deployment

1. **Build and deploy**
   ```bash
   bun run deploy
   ```

2. **Preview deployment**
   ```bash
   bun run preview
   ```

3. **Configure environment variables**
   ```bash
   # Set your backend URL
   npx wrangler secret put BACKEND_URL
   ```

### Environment Variables

Create a `.dev.vars` file for local development:

```env
# Backend API URL
BACKEND_URL=http://localhost:3001

# For production deployment, use wrangler secrets:
# npx wrangler secret put BACKEND_URL
```

## 🔌 API Integration

### tRPC Client Setup

The frontend communicates with the backend through tRPC:

- **Proxy Route**: `/api/trpc-proxy/[...trpc]` forwards requests to the backend
- **Client Configuration**: Configured in `src/lib/trpc/client.ts`
- **Provider**: Set up in `src/app/layout.tsx`
- **Hooks**: Custom hooks available in `src/lib/trpc/hooks.ts`

### Available Procedures

- `post.getPosts` - Fetch all posts with pagination
- `post.createPost` - Create a new post
- `post.getPost` - Fetch a single post by ID

## 🎨 UI Components

### shadcn/ui Setup

Components are auto-generated in the `src/components/` directory:

```bash
# Add new components
npx shadcn@latest add button input card textarea

# The components.json file configures the setup
```

### Theme Configuration

- **CSS**: Custom theme in `src/app/globals.css`
- **Colors**: Tailwind CSS custom color palette
- **Fonts**: Geist Sans (body) and Geist Mono (code)
- **Dark Mode**: Not implemented (can be added later)

## ⚡ Performance Features

- **Edge Computing**: Global distribution via Cloudflare Workers
- **Bundle Optimization**: Automatic code splitting and tree shaking
- **Image Optimization**: Built-in Next.js image optimization
- **Caching**: Edge caching with Cloudflare's global network
- **Fast Builds**: Turbopack for development, optimized production builds

## 🔧 Development Tools

### TypeScript Configuration

- **Strict Mode**: Enabled for maximum type safety
- **Path Aliases**: `@/*` maps to `src/`
- **Type Checking**: Integrated with Next.js build process

### ESLint Configuration

- **Rules**: Comprehensive linting rules for code quality
- **Integration**: Works with Next.js and TypeScript
- **Auto-fix**: Many issues can be automatically fixed

### Cloudflare Integration

- **Wrangler**: CLI tool for Cloudflare Workers development
- **Environment Types**: TypeScript definitions for Cloudflare runtime
- **Configuration**: Custom wrangler.jsonc for deployment settings

## 🐛 Troubleshooting

### Common Issues

1. **Backend Connection Issues**
   - Ensure backend is running on the configured URL
   - Check CORS configuration in backend
   - Verify environment variables are set correctly

2. **Build Issues**
   - Clear node_modules: `rm -rf node_modules && bun install`
   - Check TypeScript errors: `bun run build`
   - Verify Cloudflare compatibility

3. **Deployment Issues**
   - Check Cloudflare account permissions
   - Verify wrangler authentication: `npx wrangler auth login`
   - Check bundle size (must be under 10MB)

### Development Tips

- Use `bun run dev` for fastest development experience
- The app hot-reloads automatically on file changes
- Check the browser console for tRPC client errors
- Use the Network tab to monitor API calls

## 📚 Learn More

- [Next.js Documentation](https://nextjs.org/docs) - Next.js features and API
- [OpenNext Documentation](https://opennext.js.org/) - Deploying Next.js to Cloudflare
- [tRPC Documentation](https://trpc.io/) - Type-safe API layer
- [Tailwind CSS](https://tailwindcss.com/) - Utility-first CSS framework
- [shadcn/ui](https://ui.shadcn.com/) - Re-usable components

## 🤝 Contributing

1. Follow the existing code style and conventions
2. Test your changes thoroughly
3. Update documentation as needed
4. Ensure type safety is maintained

---

*Part of the OpenNext + tRPC + Hono + Cloudflare full-stack application*
